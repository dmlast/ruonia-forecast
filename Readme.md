# Прогноз RUONIA с помощью символических СДУ и методов SINDy

**Символьное стохастическое моделирование и прогнозирование дневной ставки RUONIA**

---

## О проекте

В рамках этого проекта разработан и всесторонне протестирован конвейер прогнозирования дневной ставки RUONIA на основе стохастических дифференциальных уравнений (СДУ) с применением как классических финансовых моделей, так и современных методов Sparse Identification of Nonlinear Dynamics (SINDy).

**Ключевые компоненты завершены:**

* **Базовая модель Vasicek** для сравнения с продвинутыми методами.
* **SINDy-like** (оптимизация структуры дрейфа через PySINDy + Optuna).
* **e-SINDy (raw)** — расширенная библиотека признаков для более точного аппроксимирования дрейфа.
* **Bayesian SINDy (raw)** — отбор структуры СДУ с апостериорными распределениями.
* **Мультигоризонтные прогнозы** на +7, +14, +30 и +180 дней с 3σ-интервалами.
* **Полная автоматизация** загрузки, предобработки и валидации (rolling-window).
* **Анализ ошибок**: расчёт MAE, RMSE и фактического coverage доверительных интервалов.

---

## Структура репозитория

```
ruonia-forecast/
├── data/                # Исходные и объединённые данные (Parquet)
├── notebooks/           # Исследовательские и воспроизводимые Jupyter-ноутбуки
│   ├── 00_eda.ipynb      # Краткий EDA и визуализация данных
│   ├── 01_1st_sindy_drift.ipynb  # Оценка дрейфа через SINDy
│   └── ...              # Полный конвейер прогнозирования + визуализация
├── src/                 # Модульный Python-код: загрузка, модели, метрики
├── docs/                # Дополнительная документация и результаты
├── environment.yml      # Описание Conda-окружения
├── requirements.txt     # Список Python-зависимостей
└── README.md            # Данный файл
```

---

## Данные

| Сериал                       | Источник         | Период                  | Частота   |
| ---------------------------- | ---------------- | ----------------------- | --------- |
| RUONIA                       | Банк России      | 2014-01-16 — 2025-07-07 | ежедневно |
| Swap‑ROISFIX                 | Московская биржа | 2014-01-16 — 2025-07-07 | ежедневно |
| ZCYC (ОФЗ)                   | Минфин РФ        | 2014-01-16 — 2025-07-07 | ежедневно |
| Валютные курсы (USD/EUR/CNY) | Мосбиржа         | 2014-01-16 — 2025-07-07 | ежедневно |
| IMOEX                        | Московская биржа | 2014-01-16 — 2025-07-07 | ежедневно |

Данные объединены и сохранены в `data/raw/merged_*.parquet`, далее проводится заполнение пропусков и фильтрация.

---

## Предобработка и EDA

* **Ноутбук:** `notebooks/00_eda.ipynb` — анализ распределения RUONIA, корреляций и сезонных эффектов.
* Заполнение пропусков методом прямой вставки (`ffill`) и удаление оставшихся NaN.

---

## Методы моделирования

1. **Vasicek** — классическая аналитическая модель.
2. **SINDy-like** — оптимизация структуры дрейфа через PySINDy и Optuna.
3. **e-SINDy (raw)** — расширенная библиотека нелинейных признаков для улучшения аппроксимации.
4. **Bayesian SINDy (raw)** — вероятностный отбор структуры с апостериорной оценкой неопределённости.

Каждый метод реализован в `src/models/` и легко расширяется.

---

## Оценка и результаты

* **Мультигоризонтные прогнозы:** +7, +14, +30, +180 дней.
* **Метрики:** MAE, RMSE и фактический процент попадания реальных значений в 3σ-интервалы (coverage).
* **Визуализация:** единый график сравнения моделей и областей не пересечения доверительных интервалов.

**Текущие результаты:**

| Horizon | Model            | Coverage\@3σ | MAE    |
| ------- | ---------------- | ------------ | ------ |
| +7      | Bayes-SINDy(raw) | 0.7976       | 0.2756 |
| +7      | SINDy-like       | 0.8095       | 0.3139 |
| +7      | Vasicek          | 1.0000       | 0.2717 |
| +7      | e-SINDy(raw)     | 0.7738       | 0.3220 |
| +14     | Bayes-SINDy(raw) | 0.7013       | 0.4105 |
| +14     | SINDy-like       | 0.6883       | 0.5324 |
| +14     | Vasicek          | 1.0000       | 0.4018 |
| +14     | e-SINDy(raw)     | 0.7792       | 0.5259 |
| +30     | Bayes-SINDy(raw) | 0.4918       | 0.8813 |
| +30     | SINDy-like       | 0.4098       | 1.2367 |
| +30     | Vasicek          | 1.0000       | 0.5408 |
| +30     | e-SINDy(raw)     | 0.5738       | 0.8811 |

---

## Основные достижения

* Чёткое разделение выборок на train/test и скользящая валидация.
* Модульная архитектура: легко добавлять новые модели и признаки.
* Автоматическая оптимизация гиперпараметров через Optuna.
* Расширенная библиотека признаков и интерактивные графики.
* Поддержка сценарного анализа и стресс-тестов денежного рынка.

---


## Roadmap: дальнейшие направления развития

Хотя базовый конвейер полностью рабочий, точность и надёжность можно ещё повысить:

1. **Улучшить покрытие доверительных интервалов**: применить Calibrated Conformal Prediction и бутстрэп для более точного σ.
2. **Снизить MAE на длинных горизонтах**: объединить предсказания SDE с GARCH/GAS и ML-ансамблями.
3. **Расширить набор признаков**: включить макроэкономические индикаторы (инфляцию, FX-волатильность, ликвидность).
4. **Углубить квантильную регрессию**: напрямую моделировать различные квантили доходности.
5. **Оптимизировать rolling-window стратегию**: автоматическое обновление параметров модели при обнаружении дрейфа.
6. **Исследовать PINS (Physics-Informed Neural SDE)**: гибридные модели SDE + нейросети для динамического σ.

---

**Контакты:**
Дмитрий Ластовецкий — [@dalastov](https://t.me/dalastov)
